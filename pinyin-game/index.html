<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ‹¼éŸ³å°æé¾™ - å¹¼å„¿å›­æ‹¼è¯»ç»ƒä¹ </title>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: "Microsoft YaHei", Arial, sans-serif;
  background: linear-gradient(135deg, #ffeaa7 0%, #74b9ff 100%);
  min-height: 100vh;
  padding: 20px;
  display: flex;
  justify-content: center;
  align-items: center;
}

.container {
  max-width: 800px;
  width: 100%;
  background: white;
  border-radius: 30px;
  padding: 30px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.15);
}

.header {
  text-align: center;
  margin-bottom: 30px;
  position: relative;
}

.header h1 {
  color: #6c5ce7;
  font-size: 36px;
  margin-bottom: 15px;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
}

.reset-btn {
  position: absolute;
  top: 0;
  right: 0;
  background: #ff7675;
  color: white;
  border: none;
  border-radius: 12px;
  padding: 10px 20px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 3px 10px rgba(255,118,117,0.3);
}

.reset-btn:hover {
  background: #d63031;
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(255,118,117,0.4);
}

.stats {
  display: flex;
  justify-content: space-around;
  margin-bottom: 25px;
  flex-wrap: wrap;
  gap: 15px;
}

.stat-item {
  background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%);
  color: white;
  padding: 15px 25px;
  border-radius: 20px;
  font-size: 18px;
  font-weight: bold;
  box-shadow: 0 4px 15px rgba(108,92,231,0.3);
}

.progress-bar {
  background: #dfe6e9;
  height: 30px;
  border-radius: 15px;
  overflow: hidden;
  margin-bottom: 25px;
  position: relative;
}

.progress-fill {
  background: linear-gradient(90deg, #55efc4 0%, #00b894 100%);
  height: 100%;
  transition: width 0.5s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: bold;
}

.question-area {
  text-align: center;
  margin-bottom: 30px;
}

.pinyin-display {
  background: linear-gradient(135deg, #fd79a8 0%, #fdcb6e 100%);
  color: white;
  font-size: 48px;
  font-weight: bold;
  padding: 30px;
  border-radius: 25px;
  margin-bottom: 25px;
  box-shadow: 0 6px 20px rgba(253,121,168,0.4);
  letter-spacing: 5px;
}

.options {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  margin-bottom: 25px;
}

.option-btn {
  background: white;
  border: 4px solid #74b9ff;
  border-radius: 20px;
  padding: 25px;
  font-size: 24px;
  font-weight: bold;
  color: #2d3436;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(116,185,255,0.3);
}

.option-btn:hover {
  background: #74b9ff;
  color: white;
  transform: translateY(-3px);
  box-shadow: 0 6px 20px rgba(116,185,255,0.5);
}

.option-btn:active {
  transform: translateY(0);
}

.option-btn.correct {
  background: #00b894;
  border-color: #00b894;
  color: white;
  animation: correctAnim 0.5s ease;
}

.option-btn.wrong {
  background: #ff7675;
  border-color: #ff7675;
  color: white;
  animation: wrongAnim 0.5s ease;
}

@keyframes correctAnim {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

@keyframes wrongAnim {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-10px); }
  75% { transform: translateX(10px); }
}

.feedback {
  text-align: center;
  font-size: 24px;
  font-weight: bold;
  min-height: 40px;
  margin-bottom: 20px;
}

.feedback.correct {
  color: #00b894;
}

.feedback.wrong {
  color: #ff7675;
}

.next-btn {
  background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
  color: white;
  border: none;
  border-radius: 20px;
  padding: 20px 50px;
  font-size: 22px;
  font-weight: bold;
  cursor: pointer;
  display: block;
  margin: 0 auto;
  box-shadow: 0 6px 20px rgba(108,92,231,0.4);
  transition: all 0.3s ease;
}

.next-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(108,92,231,0.5);
}

.next-btn:active {
  transform: translateY(0);
}

.nav-buttons {
  display: flex;
  gap: 15px;
  justify-content: center;
  margin-top: 25px;
}

.nav-btn {
  background: white;
  border: 3px solid #6c5ce7;
  color: #6c5ce7;
  border-radius: 15px;
  padding: 15px 30px;
  font-size: 18px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s ease;
}

.nav-btn:hover {
  background: #6c5ce7;
  color: white;
}

.card-unlock {
  background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
  border-radius: 25px;
  padding: 30px;
  text-align: center;
  margin: 25px 0;
  box-shadow: 0 8px 30px rgba(253,203,110,0.5);
}

.card-unlock h2 {
  color: #d63031;
  font-size: 32px;
  margin-bottom: 20px;
}

.card-display {
  background: white;
  border-radius: 20px;
  padding: 25px;
  display: inline-block;
  box-shadow: 0 6px 20px rgba(0,0,0,0.15);
}

.card-image {
  width: 200px;
  height: 200px;
  background: #dfe6e9;
  border-radius: 15px;
  margin-bottom: 15px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 80px;
  overflow: hidden;
}

.card-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.card-name {
  font-size: 24px;
  font-weight: bold;
  color: #2d3436;
}

.gallery {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 20px;
  margin-top: 25px;
}

.gallery-card {
  background: white;
  border-radius: 15px;
  padding: 15px;
  text-align: center;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
}

.gallery-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 6px 20px rgba(0,0,0,0.15);
}

.gallery-card.locked {
  opacity: 0.4;
}

.gallery-image {
  width: 100%;
  height: 120px;
  background: #dfe6e9;
  border-radius: 10px;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 50px;
  overflow: hidden;
}

.gallery-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.gallery-name {
  font-size: 16px;
  font-weight: bold;
  color: #2d3436;
}

.wrong-book {
  background: #fff5f5;
  border-radius: 20px;
  padding: 25px;
  margin-top: 25px;
}

.wrong-book h3 {
  color: #d63031;
  font-size: 24px;
  margin-bottom: 15px;
}

.wrong-item {
  background: white;
  border-left: 4px solid #ff7675;
  padding: 15px;
  margin-bottom: 10px;
  border-radius: 10px;
}

.hidden {
  display: none;
}

.screen {
  display: none;
}

.screen.active {
  display: block;
}

.completion-screen {
  text-align: center;
  padding: 40px 0;
}

.completion-screen h2 {
  color: #00b894;
  font-size: 48px;
  margin-bottom: 30px;
}

.completion-stars {
  font-size: 80px;
  margin-bottom: 30px;
}

/* ç¡®è®¤å¯¹è¯æ¡†æ ·å¼ */
.modal-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 1000;
  justify-content: center;
  align-items: center;
}

.modal-overlay.active {
  display: flex;
}

.modal-box {
  background: white;
  border-radius: 25px;
  padding: 40px;
  max-width: 400px;
  text-align: center;
  box-shadow: 0 10px 40px rgba(0,0,0,0.3);
  animation: modalPop 0.3s ease;
}

@keyframes modalPop {
  0% { transform: scale(0.8); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}

.modal-box h3 {
  color: #d63031;
  font-size: 28px;
  margin-bottom: 20px;
}

.modal-box p {
  color: #636e72;
  font-size: 18px;
  margin-bottom: 30px;
}

.modal-buttons {
  display: flex;
  gap: 15px;
  justify-content: center;
}

.modal-btn {
  padding: 15px 40px;
  border: none;
  border-radius: 15px;
  font-size: 20px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s ease;
}

.modal-btn.yes {
  background: #d63031;
  color: white;
}

.modal-btn.yes:hover {
  background: #ff7675;
  transform: translateY(-2px);
}

.modal-btn.no {
  background: #dfe6e9;
  color: #2d3436;
}

.modal-btn.no:hover {
  background: #b2bec3;
  transform: translateY(-2px);
}
</style>
</head>
<body>
<div class="container">
  <!-- æ¸¸æˆå±å¹• -->
  <div id="gameScreen" class="screen active">
    <div class="header">
      <h1>ğŸ¦• æ‹¼éŸ³å°æé¾™ ğŸ¦–</h1>
      <button class="reset-btn" onclick="showResetConfirm()">ğŸ”„ é‡ç½®</button>
    </div>
    
    <div class="stats">
      <div class="stat-item">â­ æ˜Ÿæ˜Ÿ: <span id="stars">0</span></div>
      <div class="stat-item">ğŸ”¥ è¿å¯¹: <span id="streak">0</span></div>
      <div class="stat-item">ğŸ¦´ åŒ–çŸ³: <span id="fragments">0</span>/6</div>
      <div class="stat-item">ğŸ“š ä»Šæ—¥: <span id="dailyCount">0</span>/24</div>
    </div>
    
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill" style="width: 0%;">
        <span id="progressText">0/6</span>
      </div>
    </div>
    
    <div class="question-area">
      <div class="pinyin-display" id="pinyinDisplay">lao+hu</div>
      
      <div class="options" id="optionsContainer">
        <button class="option-btn">è€è™</button>
        <button class="option-btn">è€é¼ </button>
        <button class="option-btn">å…”å­</button>
        <button class="option-btn">ç‹®å­</button>
      </div>
      
      <div class="feedback" id="feedback"></div>
      
      <button class="next-btn hidden" id="nextBtn">ä¸‹ä¸€é¢˜ â†’</button>
    </div>
    
    <div class="nav-buttons">
      <button class="nav-btn" onclick="showGallery()">ğŸ“– å›¾é‰´</button>
      <button class="nav-btn" onclick="showWrongBook()">âŒ é”™é¢˜æœ¬</button>
    </div>
  </div>
  
  <!-- å¡ç‰‡è§£é”å±å¹• -->
  <div id="unlockScreen" class="screen">
    <div class="card-unlock">
      <h2>ğŸ‰ æ­å–œè§£é”æ–°å¡ç‰‡ï¼</h2>
      <div class="card-display">
        <div class="card-image" id="unlockImage">ğŸ¦•</div>
        <div class="card-name" id="unlockName">æ­¥æ°å·¨çŒ¿</div>
      </div>
      <button class="next-btn" style="margin-top: 25px;" onclick="continueGame()">ç»§ç»­æ¢é™© â†’</button>
    </div>
  </div>
  
  <!-- å®Œæˆå±å¹• -->
  <div id="completionScreen" class="screen">
    <div class="completion-screen">
      <h2>ğŸŠ ä»Šæ—¥ä»»åŠ¡å®Œæˆï¼</h2>
      <div class="completion-stars">â­â­â­</div>
      <div class="stats">
        <div class="stat-item">â­ è·å¾—æ˜Ÿæ˜Ÿ: <span id="finalStars">0</span></div>
        <div class="stat-item">ğŸ¦´ è·å¾—åŒ–çŸ³: <span id="finalFragments">0</span></div>
      </div>
      <button class="next-btn" style="margin-top: 30px;" onclick="resetToHome()">è¿”å›é¦–é¡µ</button>
    </div>
  </div>
  
  <!-- å›¾é‰´å±å¹• -->
  <div id="galleryScreen" class="screen">
    <div class="header">
      <h1>ğŸ“– è¿œå¤ç”Ÿç‰©å›¾é‰´</h1>
    </div>
    <div class="gallery" id="galleryContainer"></div>
    <button class="next-btn" style="margin-top: 30px;" onclick="backToGame()">è¿”å›æ¸¸æˆ</button>
  </div>
  
  <!-- é”™é¢˜æœ¬å±å¹• -->
  <div id="wrongBookScreen" class="screen">
    <div class="header">
      <h1>âŒ é”™é¢˜æœ¬</h1>
    </div>
    <div class="wrong-book">
      <h3>éœ€è¦å¤šç»ƒä¹ çš„é¢˜ç›®ï¼š</h3>
      <div id="wrongList"></div>
    </div>
    <button class="next-btn" style="margin-top: 30px;" onclick="backToGame()">è¿”å›æ¸¸æˆ</button>
  </div>
</div>

<!-- é‡ç½®ç¡®è®¤å¯¹è¯æ¡† -->
<div class="modal-overlay" id="resetModal">
  <div class="modal-box">
    <h3>âš ï¸ ç¡®å®šé‡æ¥å—ï¼Ÿ</h3>
    <p>æ‰€æœ‰è¿›åº¦ï¼ˆæ˜Ÿæ˜Ÿã€åŒ–çŸ³ã€å¡ç‰‡ï¼‰éƒ½ä¼šæ¸…ç©ºå“¦ï¼</p>
    <div class="modal-buttons">
      <button class="modal-btn no" onclick="hideResetConfirm()">ä¸è¦</button>
      <button class="modal-btn yes" onclick="confirmReset()">ç¡®å®š</button>
    </div>
  </div>
</div>

<script>
// é¢˜åº“ - å…¨æ–°å†…å®¹ï¼Œæ¯ç±»16é¢˜
const questionBank = [
  // ç”Ÿæ´»ç”¨å“ (16é¢˜)
  { pinyin: 'kuai+zi', answer: 'ç­·å­', options: ['ç­·å­', 'å‹ºå­', 'å‰å­', 'ç¢—'] },
  { pinyin: 'shui+ping', answer: 'æ°´ç“¶', options: ['æ°´ç“¶', 'èŒ¶æ¯', 'æ°´å£¶', 'ä¿æ¸©æ¯'] },
  { pinyin: 'zhen+tou', answer: 'æ•å¤´', options: ['æ•å¤´', 'è¢«å­', 'åºŠå•', 'æ¯¯å­'] },
  { pinyin: 'shou+biao', answer: 'æ‰‹è¡¨', options: ['æ‰‹è¡¨', 'é—¹é’Ÿ', 'é’Ÿè¡¨', 'æ‰‹æœº'] },
  { pinyin: 'yu+san', answer: 'é›¨ä¼', options: ['é›¨ä¼', 'é›¨è¡£', 'é›¨é‹', 'å¸½å­'] },
  { pinyin: 'deng+long', answer: 'ç¯ç¬¼', options: ['ç¯ç¬¼', 'èœ¡çƒ›', 'å°ç¯', 'ç”µç¯'] },
  { pinyin: 'shua+zi', answer: 'åˆ·å­', options: ['åˆ·å­', 'æŠ¹å¸ƒ', 'æ‰«æŠŠ', 'æ‹–æŠŠ'] },
  { pinyin: 'jing+zi', answer: 'é•œå­', options: ['é•œå­', 'ç»ç’ƒ', 'çª—æˆ·', 'ç›¸æ¡†'] },
  { pinyin: 'yao+shi', answer: 'é’¥åŒ™', options: ['é’¥åŒ™', 'é”å¤´', 'é—¨é“ƒ', 'æŠŠæ‰‹'] },
  { pinyin: 'bei+bao', answer: 'èƒŒåŒ…', options: ['èƒŒåŒ…', 'æ‰‹æåŒ…', 'é’±åŒ…', 'ä¹¦åŒ…'] },
  { pinyin: 'mao+jin', answer: 'æ¯›å·¾', options: ['æ¯›å·¾', 'æµ´å·¾', 'æ‰‹å¸•', 'å›´å·¾'] },
  { pinyin: 'fei+zao', answer: 'è‚¥çš‚', options: ['è‚¥çš‚', 'æ´—å‘æ°´', 'æ²æµ´éœ²', 'ç‰™è†'] },
  { pinyin: 'shu+zi', answer: 'æ¢³å­', options: ['æ¢³å­', 'å‘å¤¹', 'çš®ç­‹', 'é•œå­'] },
  { pinyin: 'wa+wa', answer: 'å¨ƒå¨ƒ', options: ['å¨ƒå¨ƒ', 'ç©å¶', 'æ¯›ç»’ç†Š', 'å¸ƒå¨ƒå¨ƒ'] },
  { pinyin: 'hua+ping', answer: 'èŠ±ç“¶', options: ['èŠ±ç“¶', 'æ°´æ¯', 'èŒ¶å£¶', 'ç›˜å­'] },
  { pinyin: 'shou+tao', answer: 'æ‰‹å¥—', options: ['æ‰‹å¥—', 'è¢œå­', 'å›´å·¾', 'å¸½å­'] },
  
  // åŠ¨ç‰© (16é¢˜)
  { pinyin: 'xiong+mao', answer: 'ç†ŠçŒ«', options: ['ç†ŠçŒ«', 'é»‘ç†Š', 'åŒ—æç†Š', 'æ£•ç†Š'] },
  { pinyin: 'song+shu', answer: 'æ¾é¼ ', options: ['æ¾é¼ ', 'ä»“é¼ ', 'å…”å­', 'è€é¼ '] },
  { pinyin: 'hai+tun', answer: 'æµ·è±š', options: ['æµ·è±š', 'é²¸é±¼', 'æµ·è±¹', 'æµ·ç‹®'] },
  { pinyin: 'hou+zi', answer: 'çŒ´å­', options: ['çŒ´å­', 'çŒ©çŒ©', 'ç‹’ç‹’', 'é•¿è‡‚çŒ¿'] },
  { pinyin: 'chang+jing+lu', answer: 'é•¿é¢ˆé¹¿', options: ['é•¿é¢ˆé¹¿', 'æ–‘é©¬', 'é¹¿', 'ç¾šç¾Š'] },
  { pinyin: 'qi+e', answer: 'ä¼é¹…', options: ['ä¼é¹…', 'æµ·é¸¥', 'é¸­å­', 'å¤©é¹…'] },
  { pinyin: 'kao+la', answer: 'è€ƒæ‹‰', options: ['è€ƒæ‹‰', 'æ ‘æ‡’', 'æµ£ç†Š', 'ç†ŠçŒ«'] },
  { pinyin: 'lao+shu', answer: 'è€é¼ ', options: ['è€é¼ ', 'æ¾é¼ ', 'ç”°é¼ ', 'ä»“é¼ '] },
  { pinyin: 'ban+ma', answer: 'æ–‘é©¬', options: ['æ–‘é©¬', 'é©¬', 'é©´', 'éª¡å­'] },
  { pinyin: 'zhi+zhu', answer: 'èœ˜è››', options: ['èœ˜è››', 'èš‚èš', 'èœœèœ‚', 'è´è¶'] },
  { pinyin: 'qing+wa', answer: 'é’è›™', options: ['é’è›™', 'èŸ¾èœ', 'èŒèšª', 'ä¹Œé¾Ÿ'] },
  { pinyin: 'shi+zi', answer: 'ç‹®å­', options: ['ç‹®å­', 'è€è™', 'è±¹å­', 'çŒè±¹'] },
  { pinyin: 'gong+ji', answer: 'å…¬é¸¡', options: ['å…¬é¸¡', 'æ¯é¸¡', 'å°é¸¡', 'é¸­å­'] },
  { pinyin: 'xiao+yang', answer: 'å°ç¾Š', options: ['å°ç¾Š', 'å±±ç¾Š', 'ç»µç¾Š', 'å°ç‰›'] },
  { pinyin: 'kong+que', answer: 'å­”é›€', options: ['å­”é›€', 'é¹¦é¹‰', 'å¤©é¹…', 'é¸½å­'] },
  { pinyin: 'mi+feng', answer: 'èœœèœ‚', options: ['èœœèœ‚', 'è´è¶', 'èœ»èœ“', 'é©¬èœ‚'] },
  
  // æ¤ç‰© (16é¢˜)
  { pinyin: 'tao+hua', answer: 'æ¡ƒèŠ±', options: ['æ¡ƒèŠ±', 'æ¢…èŠ±', 'æ¨±èŠ±', 'æèŠ±'] },
  { pinyin: 'zhu+zi', answer: 'ç«¹å­', options: ['ç«¹å­', 'èŠ¦è‹‡', 'ç”˜è”—', 'æœ¨å¤´'] },
  { pinyin: 'he+hua', answer: 'è·èŠ±', options: ['è·èŠ±', 'è²èŠ±', 'ç¡è²', 'æ°´ä»™'] },
  { pinyin: 'liu+shu', answer: 'æŸ³æ ‘', options: ['æŸ³æ ‘', 'æ¨æ ‘', 'æ§æ ‘', 'æ¦†æ ‘'] },
  { pinyin: 'song+shu', answer: 'æ¾æ ‘', options: ['æ¾æ ‘', 'æŸæ ‘', 'æ‰æ ‘', 'æ¡¦æ ‘'] },
  { pinyin: 'lan+hua', answer: 'å…°èŠ±', options: ['å…°èŠ±', 'èŠèŠ±', 'ç‰¡ä¸¹', 'èŒ‰è‰'] },
  { pinyin: 'pu+gong+ying', answer: 'è’²å…¬è‹±', options: ['è’²å…¬è‹±', 'å‘æ—¥è‘µ', 'é›èŠ', 'é‡èŠ±'] },
  { pinyin: 'cai+hua', answer: 'èœèŠ±', options: ['èœèŠ±', 'æ²¹èœ', 'èŠ±èœ', 'è¥¿è“èŠ±'] },
  { pinyin: 'xi+gua', answer: 'è¥¿ç“œ', options: ['è¥¿ç“œ', 'ç”œç“œ', 'å—ç“œ', 'å†¬ç“œ'] },
  { pinyin: 'cao+mei', answer: 'è‰è“', options: ['è‰è“', 'æ¨±æ¡ƒ', 'è“è“', 'æ ‘è“'] },
  { pinyin: 'tao+zi', answer: 'æ¡ƒå­', options: ['æ¡ƒå­', 'æå­', 'æå­', 'æ¢…å­'] },
  { pinyin: 'li+zi', answer: 'æ¢¨å­', options: ['æ¢¨å­', 'è‹¹æœ', 'æ©˜å­', 'æŸ¿å­'] },
  { pinyin: 'bo+luo', answer: 'è è', options: ['è è', 'æ¦´è²', 'èŠ’æœ', 'ç«é¾™æœ'] },
  { pinyin: 'bai+cai', answer: 'ç™½èœ', options: ['ç™½èœ', 'é’èœ', 'æ²¹èœ', 'ç”Ÿèœ'] },
  { pinyin: 'hu+luo+bo', answer: 'èƒ¡èåœ', options: ['èƒ¡èåœ', 'ç™½èåœ', 'çº¢è–¯', 'åœŸè±†'] },
  { pinyin: 'fan+qie', answer: 'ç•ªèŒ„', options: ['ç•ªèŒ„', 'è¥¿çº¢æŸ¿', 'è¾£æ¤’', 'èŒ„å­'] },
  
  // äº¤é€šå·¥å…· (16é¢˜)
  { pinyin: 'chu+zu+che', answer: 'å‡ºç§Ÿè½¦', options: ['å‡ºç§Ÿè½¦', 'å…¬äº¤è½¦', 'å°æ±½è½¦', 'é¢åŒ…è½¦'] },
  { pinyin: 'jing+che', answer: 'è­¦è½¦', options: ['è­¦è½¦', 'æ•‘æŠ¤è½¦', 'æ¶ˆé˜²è½¦', 'å‡ºç§Ÿè½¦'] },
  { pinyin: 'huo+jian', answer: 'ç«ç®­', options: ['ç«ç®­', 'é£æœº', 'å«æ˜Ÿ', 'é£èˆ¹'] },
  { pinyin: 'di+tie', answer: 'åœ°é“', options: ['åœ°é“', 'ç«è½¦', 'é«˜é“', 'è½»è½¨'] },
  { pinyin: 'gong+jiao+che', answer: 'å…¬äº¤è½¦', options: ['å…¬äº¤è½¦', 'å¤§å·´è½¦', 'æ ¡è½¦', 'æ—…æ¸¸è½¦'] },
  { pinyin: 'xiao+chuan', answer: 'å°èˆ¹', options: ['å°èˆ¹', 'æœ¨èˆ¹', 'å¸†èˆ¹', 'æ¸”èˆ¹'] },
  { pinyin: 'ka+che', answer: 'å¡è½¦', options: ['å¡è½¦', 'è´§è½¦', 'åŠè½¦', 'æ‹–è½¦'] },
  { pinyin: 'mo+tuo+che', answer: 'æ‘©æ‰˜è½¦', options: ['æ‘©æ‰˜è½¦', 'ç”µåŠ¨è½¦', 'è‡ªè¡Œè½¦', 'ä¸‰è½®è½¦'] },
  { pinyin: 'lun+chuan', answer: 'è½®èˆ¹', options: ['è½®èˆ¹', 'æ¸¸è‰‡', 'å¸†èˆ¹', 'å°èˆ¹'] },
  { pinyin: 'zhi+sheng+ji', answer: 'ç›´å‡æœº', options: ['ç›´å‡æœº', 'é£æœº', 'æˆ˜æ–—æœº', 'å®¢æœº'] },
  { pinyin: 'la+che', answer: 'æ‹‰è½¦', options: ['æ‹‰è½¦', 'æ¨è½¦', 'é©¬è½¦', 'æ¿è½¦'] },
  { pinyin: 'dian+dong+che', answer: 'ç”µåŠ¨è½¦', options: ['ç”µåŠ¨è½¦', 'æ‘©æ‰˜è½¦', 'è‡ªè¡Œè½¦', 'ä¸‰è½®è½¦'] },
  { pinyin: 'xiao+jiao+che', answer: 'æ ¡è½¦', options: ['æ ¡è½¦', 'å…¬äº¤è½¦', 'å¤§å·´è½¦', 'é¢åŒ…è½¦'] },
  { pinyin: 'diao+che', answer: 'åŠè½¦', options: ['åŠè½¦', 'å¡è½¦', 'æŒ–æ˜æœº', 'æ¨åœŸæœº'] },
  { pinyin: 'shan+che', answer: 'å±±è½¦', options: ['å±±è½¦', 'æ»‘æ¿', 'æ»‘æ¢¯', 'ç§‹åƒ'] },
  { pinyin: 'you+ting', answer: 'æ¸¸è‰‡', options: ['æ¸¸è‰‡', 'å¸†èˆ¹', 'å¿«è‰‡', 'è½®èˆ¹'] },
  
  // æ—¥å¸¸çŸ­å¥ (16é¢˜)
  { pinyin: 'zao+shang+hao', answer: 'æ—©ä¸Šå¥½', options: ['æ—©ä¸Šå¥½', 'æ™šä¸Šå¥½', 'ä¸­åˆå¥½', 'ä¸‹åˆå¥½'] },
  { pinyin: 'wan+shang+hao', answer: 'æ™šä¸Šå¥½', options: ['æ™šä¸Šå¥½', 'æ—©ä¸Šå¥½', 'ä¸­åˆå¥½', 'ä½ å¥½'] },
  { pinyin: 'dui+bu+qi', answer: 'å¯¹ä¸èµ·', options: ['å¯¹ä¸èµ·', 'æ²¡å…³ç³»', 'ä¸å®¢æ°”', 'è°¢è°¢'] },
  { pinyin: 'mei+guan+xi', answer: 'æ²¡å…³ç³»', options: ['æ²¡å…³ç³»', 'ä¸å®¢æ°”', 'å¯¹ä¸èµ·', 'æ²¡äº‹'] },
  { pinyin: 'bu+ke+qi', answer: 'ä¸å®¢æ°”', options: ['ä¸å®¢æ°”', 'æ²¡å…³ç³»', 'è°¢è°¢', 'å¯¹ä¸èµ·'] },
  { pinyin: 'qing+jin', answer: 'è¯·è¿›', options: ['è¯·è¿›', 'è¯·å', 'è¯·èµ°', 'è¯·å‡ºå»'] },
  { pinyin: 'he+shui', answer: 'å–æ°´', options: ['å–æ°´', 'åƒé¥­', 'å–èŒ¶', 'å–å¥¶'] },
  { pinyin: 'qi+chuang', answer: 'èµ·åºŠ', options: ['èµ·åºŠ', 'ç¡è§‰', 'æ´—è„¸', 'ç©¿è¡£'] },
  { pinyin: 'xi+lian', answer: 'æ´—è„¸', options: ['æ´—è„¸', 'æ´—æ‰‹', 'åˆ·ç‰™', 'æ´—æ¾¡'] },
  { pinyin: 'xi+shou', answer: 'æ´—æ‰‹', options: ['æ´—æ‰‹', 'æ´—è„¸', 'æ´—è„š', 'æ´—æ¾¡'] },
  { pinyin: 'chuan+yi+fu', answer: 'ç©¿è¡£æœ', options: ['ç©¿è¡£æœ', 'è„±è¡£æœ', 'æ´—è¡£æœ', 'å è¡£æœ'] },
  { pinyin: 'kan+dian+shi', answer: 'çœ‹ç”µè§†', options: ['çœ‹ç”µè§†', 'çœ‹ä¹¦', 'çœ‹æŠ¥', 'çœ‹ç”µå½±'] },
  { pinyin: 'zuo+zuo+ye', answer: 'åšä½œä¸š', options: ['åšä½œä¸š', 'å†™ä½œä¸š', 'çœ‹ä¹¦', 'ä¸Šè¯¾'] },
  { pinyin: 'chi+zao+fan', answer: 'åƒæ—©é¥­', options: ['åƒæ—©é¥­', 'åƒåˆé¥­', 'åƒæ™šé¥­', 'åƒé¥­'] },
  { pinyin: 'wo+ai+ma+ma', answer: 'æˆ‘çˆ±å¦ˆå¦ˆ', options: ['æˆ‘çˆ±å¦ˆå¦ˆ', 'æˆ‘çˆ±çˆ¸çˆ¸', 'æˆ‘çˆ±ä½ ', 'æˆ‘æƒ³ä½ '] },
  { pinyin: 'ming+tian+jian', answer: 'æ˜å¤©è§', options: ['æ˜å¤©è§', 'å†è§', 'å›è§', 'ä¸€ä¼šè§'] }
];

// è¿œå¤ç”Ÿç‰©å¡ç‰‡
const dinoCards = [
  { name: 'éœ¸ç‹é¾™', emoji: 'ğŸŸ', image: 'assets/g13_éœ¸ç‹é¾™.jpg' },
  { name: 'ä¸‰è§’é¾™', emoji: 'ğŸŸ', image: 'assets/ä¸‰è§’é¾™.jpg' },
  { name: 'é˜¿æ ¹å»·é¾™', emoji: 'ğŸŸ', image: 'assets/é˜¿æ ¹å»·é¾™.jpg' },
  { name: 'èŠçŸ³', emoji: 'ğŸŸ', image: 'assets/èŠçŸ³.jpg' },
  { name: 'ä¸‰å¶è™«', emoji: 'ğŸŸ', image: 'assets/ä¸‰å¶è™«.jpg' },
  { name: 'å¥¥ç‰¹æ›¼', emoji: 'ğŸŸ', image: 'assets/1aoteman.jpg' },
  { name: 'å¥¥ç‰¹æ›¼', emoji: 'ğŸŸ', image: 'assets/2aoteman.jpg' },
  { name: 'å¥¥ç‰¹æ›¼', emoji: 'ğŸŸ', image: 'assets/3aoteman.jpg' },
  { name: 'å¥¥ç‰¹æ›¼', emoji: 'ğŸŸ', image: 'assets/4aoteman.jpg' },
  { name: 'å¥¥ç‰¹æ›¼', emoji: 'ğŸŸ', image: 'assets/5aoteman.jpg' },
  { name: 'å¥¥ç‰¹æ›¼', emoji: 'ğŸŸ', image: 'assets/6aoteman.jpg' },
  { name: 'å¥¥ç‰¹æ›¼', emoji: 'ğŸŸ', image: 'assets/7aoteman.jpg' },
  { name: 'å¥¥ç‰¹æ›¼', emoji: 'ğŸŸ', image: 'assets/8aoteman.jpg' },
  { name: 'å¥¥ç‰¹æ›¼', emoji: 'ğŸŸ', image: 'assets/9aoteman.jpg' },
  { name: 'å¥¥ç‰¹æ›¼', emoji: 'ğŸŸ', image: 'assets/10aoteman.jpg' },
  { name: 'å¥¥ç‰¹æ›¼', emoji: 'ğŸŸ', image: 'assets/11aoteman.jpg' },
  { name: 'è¿œå¤', emoji: 'ğŸŸ', image: 'assets/1pintu.jpg' },
  { name: 'è¿œå¤', emoji: 'ğŸŸ', image: 'assets/2pintu.jpg' }
];

// éŸ³æ•ˆç³»ç»Ÿ - ä½¿ç”¨ Web Audio API ç”Ÿæˆç®€çŸ­éŸ³æ•ˆ
const AudioContext = window.AudioContext || window.webkitAudioContext;
const audioContext = new AudioContext();

// ç”Ÿæˆç­”å¯¹éŸ³æ•ˆ (å®/bling - 0.3ç§’)
function playCorrectSound() {
  const oscillator = audioContext.createOscillator();
  const gainNode = audioContext.createGain();
  
  oscillator.connect(gainNode);
  gainNode.connect(audioContext.destination);
  
  oscillator.frequency.value = 800;
  oscillator.type = 'sine';
  
  gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
  gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
  
  oscillator.start(audioContext.currentTime);
  oscillator.stop(audioContext.currentTime + 0.3);
  
  // æ·»åŠ ç¬¬äºŒä¸ªéŸ³ç¬¦åˆ¶é€ "å®"çš„æ„Ÿè§‰
  setTimeout(() => {
    const osc2 = audioContext.createOscillator();
    const gain2 = audioContext.createGain();
    
    osc2.connect(gain2);
    gain2.connect(audioContext.destination);
    
    osc2.frequency.value = 1000;
    osc2.type = 'sine';
    
    gain2.gain.setValueAtTime(0.2, audioContext.currentTime);
    gain2.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
    
    osc2.start(audioContext.currentTime);
    osc2.stop(audioContext.currentTime + 0.2);
  }, 50);
}

// ç”Ÿæˆç­”é”™éŸ³æ•ˆ (è½»æŸ”å’š - 0.4ç§’)
function playWrongSound() {
  const oscillator = audioContext.createOscillator();
  const gainNode = audioContext.createGain();
  
  oscillator.connect(gainNode);
  gainNode.connect(audioContext.destination);
  
  oscillator.frequency.value = 200;
  oscillator.type = 'sine';
  
  gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
  gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
  
  oscillator.start(audioContext.currentTime);
  oscillator.stop(audioContext.currentTime + 0.4);
}

// ç”Ÿæˆè§£é”éŸ³æ•ˆ (èƒœåˆ©å·è§’ - æ¿€æ˜‚çƒ­çƒˆ - çº¦1ç§’)
function playUnlockSound() {
  // å·è§’å¼ä¸Šå‡éŸ³é˜¶ï¼šC4 -> E4 -> G4 -> C5 -> E5
  const victoryNotes = [
    { freq: 261.63, duration: 0.15, delay: 0 },      // C4
    { freq: 329.63, duration: 0.15, delay: 0.12 },   // E4
    { freq: 392.00, duration: 0.15, delay: 0.24 },   // G4
    { freq: 523.25, duration: 0.25, delay: 0.36 },   // C5 (æ›´é•¿)
    { freq: 659.25, duration: 0.35, delay: 0.56 }    // E5 (æœ€é•¿æœ€å“äº®)
  ];
  
  victoryNotes.forEach(note => {
    setTimeout(() => {
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      oscillator.frequency.value = note.freq;
      oscillator.type = 'square'; // ä½¿ç”¨æ–¹æ³¢åˆ¶é€ å·è§’æ„Ÿ
      
      // æœ€åä¸€ä¸ªéŸ³ç¬¦æ›´å“äº®
      const volume = note.delay > 0.5 ? 0.4 : 0.3;
      gainNode.gain.setValueAtTime(volume, audioContext.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + note.duration);
      
      oscillator.start(audioContext.currentTime);
      oscillator.stop(audioContext.currentTime + note.duration);
    }, note.delay * 1000);
  });
  
  // æ·»åŠ åº•éŸ³å¢å¼ºå·è§’æ•ˆæœ
  setTimeout(() => {
    const bass = audioContext.createOscillator();
    const bassGain = audioContext.createGain();
    
    bass.connect(bassGain);
    bassGain.connect(audioContext.destination);
    
    bass.frequency.value = 130.81; // C3
    bass.type = 'sawtooth';
    
    bassGain.gain.setValueAtTime(0.15, audioContext.currentTime);
    bassGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.8);
    
    bass.start(audioContext.currentTime);
    bass.stop(audioContext.currentTime + 0.8);
  }, 360);
}

// æ¸¸æˆçŠ¶æ€
let gameState = {
  stars: 0,
  streak: 0,
  fragments: 0,
  dailyCount: 0,
  currentRound: 0,
  currentQuestion: 0,
  questions: [],
  unlockedCards: [],
  wrongQuestions: [],
  answered: false,
  usedQuestionsInRound: [] // æ–°å¢ï¼šè®°å½•æœ¬è½®å·²ä½¿ç”¨çš„é¢˜ç›®
};

// åˆå§‹åŒ–
function init() {
  loadProgress();
  checkDailyReset();
  updateStats();
  startNewRound();
  renderGallery();
}

// åŠ è½½è¿›åº¦
function loadProgress() {
  const saved = localStorage.getItem('pinyinGameProgress');
  if (saved) {
    const data = JSON.parse(saved);
    gameState.stars = data.stars || 0;
    gameState.fragments = data.fragments || 0;
    gameState.dailyCount = data.dailyCount || 0;
    gameState.unlockedCards = data.unlockedCards || [];
    gameState.wrongQuestions = data.wrongQuestions || [];
    gameState.lastPlayDate = data.lastPlayDate || '';
  }
}

// ä¿å­˜è¿›åº¦
function saveProgress() {
  const data = {
    stars: gameState.stars,
    fragments: gameState.fragments,
    dailyCount: gameState.dailyCount,
    unlockedCards: gameState.unlockedCards,
    wrongQuestions: gameState.wrongQuestions,
    lastPlayDate: new Date().toDateString()
  };
  localStorage.setItem('pinyinGameProgress', JSON.stringify(data));
}

// æ£€æŸ¥æ—¥æœŸé‡ç½®
function checkDailyReset() {
  const today = new Date().toDateString();
  if (gameState.lastPlayDate !== today) {
    gameState.dailyCount = 0;
    gameState.streak = 0;
  }
}

// å¼€å§‹æ–°ä¸€è½®
function startNewRound() {
  if (gameState.dailyCount >= 24) {
    showCompletion();
    return;
  }
  
  gameState.currentQuestion = 0;
  gameState.usedQuestionsInRound = []; // é‡ç½®æœ¬è½®å·²ä½¿ç”¨é¢˜ç›®
  gameState.questions = getRandomQuestions(6);
  showQuestion();
}

// è·å–éšæœºé¢˜ç›®ï¼ˆç¡®ä¿æœ¬è½®ä¸é‡å¤ï¼‰
function getRandomQuestions(count) {
  const available = questionBank.filter(q => 
    !gameState.usedQuestionsInRound.includes(q.pinyin)
  );
  
  // å¦‚æœå¯ç”¨é¢˜ç›®ä¸è¶³ï¼Œé‡ç½®æœ¬è½®è®°å½•
  if (available.length < count) {
    gameState.usedQuestionsInRound = [];
    return getRandomQuestions(count);
  }
  
  const shuffled = [...available].sort(() => Math.random() - 0.5);
  const selected = shuffled.slice(0, count);
  
  // è®°å½•æœ¬è½®å·²ä½¿ç”¨çš„é¢˜ç›®
  selected.forEach(q => {
    gameState.usedQuestionsInRound.push(q.pinyin);
  });
  
  return selected;
}

// æ˜¾ç¤ºé¢˜ç›®
function showQuestion() {
  gameState.answered = false;
  const question = gameState.questions[gameState.currentQuestion];
  
  document.getElementById('pinyinDisplay').textContent = question.pinyin;
  
  const shuffledOptions = [...question.options].sort(() => Math.random() - 0.5);
  const container = document.getElementById('optionsContainer');
  container.innerHTML = '';
  
  shuffledOptions.forEach(option => {
    const btn = document.createElement('button');
    btn.className = 'option-btn';
    btn.textContent = option;
    btn.onclick = () => checkAnswer(option, question.answer);
    container.appendChild(btn);
  });
  
  document.getElementById('feedback').textContent = '';
  document.getElementById('feedback').className = 'feedback';
  document.getElementById('nextBtn').classList.add('hidden');
  
  updateProgress();
}

// æ£€æŸ¥ç­”æ¡ˆ
function checkAnswer(selected, correct) {
  if (gameState.answered) return;
  gameState.answered = true;
  
  const buttons = document.querySelectorAll('.option-btn');
  const feedback = document.getElementById('feedback');
  
  buttons.forEach(btn => {
    btn.style.pointerEvents = 'none';
    if (btn.textContent === correct) {
      btn.classList.add('correct');
    } else if (btn.textContent === selected) {
      btn.classList.add('wrong');
    }
  });
  
  if (selected === correct) {
    playCorrectSound(); // æ’­æ”¾ç­”å¯¹éŸ³æ•ˆ
    gameState.stars++;
    gameState.streak++;
    gameState.fragments++;
    feedback.textContent = 'ğŸ‰ å¤ªæ£’äº†ï¼ç­”å¯¹äº†ï¼';
    feedback.className = 'feedback correct';
    
    if (gameState.fragments >= 6) {
      setTimeout(() => unlockCard(), 1000);
      return;
    }
  } else {
    playWrongSound(); // æ’­æ”¾ç­”é”™éŸ³æ•ˆ
    gameState.streak = 0;
    feedback.textContent = 'ğŸ’ª å†æƒ³æƒ³ï¼Œç­”æ¡ˆæ˜¯ï¼š' + correct;
    feedback.className = 'feedback wrong';
    
    const question = gameState.questions[gameState.currentQuestion];
    addToWrongBook(question);
  }
  
  updateStats();
  saveProgress();
  document.getElementById('nextBtn').classList.remove('hidden');
}

// æ·»åŠ åˆ°é”™é¢˜æœ¬
function addToWrongBook(question) {
  const exists = gameState.wrongQuestions.find(q => q.pinyin === question.pinyin);
  if (!exists) {
    gameState.wrongQuestions.push({
      pinyin: question.pinyin,
      answer: question.answer,
      count: 1
    });
  } else {
    exists.count++;
  }
}

// ä¸‹ä¸€é¢˜
function nextQuestion() {
  gameState.currentQuestion++;
  gameState.dailyCount++;
  
  if (gameState.currentQuestion >= gameState.questions.length) {
    if (gameState.dailyCount >= 24) {
      showCompletion();
    } else {
      startNewRound();
    }
  } else {
    showQuestion();
  }
  
  saveProgress();
}

// è§£é”å¡ç‰‡
function unlockCard() {
  playUnlockSound(); // æ’­æ”¾èƒœåˆ©å·è§’éŸ³æ•ˆ
  
  const availableCards = dinoCards.filter((_, index) => 
    !gameState.unlockedCards.includes(index)
  );
  
  if (availableCards.length === 0) {
    nextQuestion();
    return;
  }
  
  const randomCard = availableCards[Math.floor(Math.random() * availableCards.length)];
  const cardIndex = dinoCards.indexOf(randomCard);
  
  gameState.unlockedCards.push(cardIndex);
  gameState.fragments = 0;
  
  document.getElementById('unlockImage').innerHTML = 
    `<img src="${randomCard.image}" onerror="this.parentElement.innerHTML='${randomCard.emoji}'" alt="${randomCard.name}">`;
  document.getElementById('unlockName').textContent = randomCard.name;
  
  switchScreen('unlockScreen');
  updateStats();
  saveProgress();
  renderGallery();
}

// ç»§ç»­æ¸¸æˆ
function continueGame() {
  switchScreen('gameScreen');
  nextQuestion();
}

// æ˜¾ç¤ºå®Œæˆç•Œé¢
function showCompletion() {
  document.getElementById('finalStars').textContent = gameState.stars;
  document.getElementById('finalFragments').textContent = gameState.unlockedCards.length;
  switchScreen('completionScreen');
}

// è¿”å›é¦–é¡µï¼ˆé‡ç½®ä»Šæ—¥è¿›åº¦ä½†ä¿ç•™æ€»è¿›åº¦ï¼‰
function resetToHome() {
  gameState.dailyCount = 0;
  gameState.streak = 0;
  gameState.currentQuestion = 0;
  gameState.currentRound = 0;
  gameState.usedQuestionsInRound = [];
  
  saveProgress();
  updateStats();
  
  switchScreen('gameScreen');
  startNewRound();
}

// æ˜¾ç¤ºé‡ç½®ç¡®è®¤å¯¹è¯æ¡†
function showResetConfirm() {
  document.getElementById('resetModal').classList.add('active');
}

// éšè—é‡ç½®ç¡®è®¤å¯¹è¯æ¡†
function hideResetConfirm() {
  document.getElementById('resetModal').classList.remove('active');
}

// ç¡®è®¤é‡ç½® - æ¸…ç©ºæ‰€æœ‰æ•°æ®
function confirmReset() {
  // æ¸…ç©º localStorage
  localStorage.removeItem('pinyinGameProgress');
  
  // é‡ç½®æ¸¸æˆçŠ¶æ€
  gameState = {
    stars: 0,
    streak: 0,
    fragments: 0,
    dailyCount: 0,
    currentRound: 0,
    currentQuestion: 0,
    questions: [],
    unlockedCards: [],
    wrongQuestions: [],
    answered: false,
    usedQuestionsInRound: []
  };
  
  // éšè—å¯¹è¯æ¡†
  hideResetConfirm();
  
  // æ›´æ–°æ˜¾ç¤º
  updateStats();
  renderGallery();
  
  // è¿”å›æ¸¸æˆå±å¹•å¹¶å¼€å§‹æ–°æ¸¸æˆ
  switchScreen('gameScreen');
  startNewRound();
}

// æ˜¾ç¤ºå›¾é‰´
function showGallery() {
  renderGallery();
  switchScreen('galleryScreen');
}

// æ¸²æŸ“å›¾é‰´
function renderGallery() {
  const container = document.getElementById('galleryContainer');
  container.innerHTML = '';
  
  dinoCards.forEach((card, index) => {
    const isUnlocked = gameState.unlockedCards.includes(index);
    const div = document.createElement('div');
    div.className = 'gallery-card' + (isUnlocked ? '' : ' locked');
    div.innerHTML = `
      <div class="gallery-image">
        ${isUnlocked ? 
          `<img src="${card.image}" onerror="this.parentElement.innerHTML='${card.emoji}'" alt="${card.name}">` : 
          'ğŸ”’'}
      </div>
      <div class="gallery-name">${isUnlocked ? card.name : '???'}</div>
    `;
    container.appendChild(div);
  });
}

// æ˜¾ç¤ºé”™é¢˜æœ¬
function showWrongBook() {
  const container = document.getElementById('wrongList');
  container.innerHTML = '';
  
  if (gameState.wrongQuestions.length === 0) {
    container.innerHTML = '<div style="text-align:center;color:#636e72;padding:20px;">è¿˜æ²¡æœ‰é”™é¢˜ï¼Œç»§ç»­åŠ æ²¹ï¼</div>';
  } else {
    gameState.wrongQuestions.forEach(q => {
      const div = document.createElement('div');
      div.className = 'wrong-item';
      div.innerHTML = `
        <div style="font-size:20px;font-weight:bold;margin-bottom:5px;">${q.pinyin}</div>
        <div style="color:#636e72;">æ­£ç¡®ç­”æ¡ˆï¼š${q.answer} (é”™è¯¯${q.count}æ¬¡)</div>
      `;
      container.appendChild(div);
    });
  }
  
  switchScreen('wrongBookScreen');
}

// è¿”å›æ¸¸æˆ
function backToGame() {
  switchScreen('gameScreen');
}

// åˆ‡æ¢å±å¹•
function switchScreen(screenId) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(screenId).classList.add('active');
}

// æ›´æ–°ç»Ÿè®¡
function updateStats() {
  document.getElementById('stars').textContent = gameState.stars;
  document.getElementById('streak').textContent = gameState.streak;
  document.getElementById('fragments').textContent = gameState.fragments;
  document.getElementById('dailyCount').textContent = gameState.dailyCount;
}

// æ›´æ–°è¿›åº¦æ¡
function updateProgress() {
  const progress = (gameState.currentQuestion / gameState.questions.length) * 100;
  document.getElementById('progressFill').style.width = progress + '%';
  document.getElementById('progressText').textContent = 
    `${gameState.currentQuestion}/${gameState.questions.length}`;
}

// ä¸‹ä¸€é¢˜æŒ‰é’®
document.getElementById('nextBtn').onclick = nextQuestion;

// å¯åŠ¨
init();
</script>
</body>
</html>